<!DOCTYPE html>
<html>

<head>
    <title>VR Hexadecagon Museum</title>

    <!-- A-Frame 1.2.0 (Best for Cardboard / JioDive) -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>

    <script>
        /* ===============================
           HEXADECAGON WALLS
        =============================== */
        AFRAME.registerComponent('hexadecagon-walls', {
            init: function () {
                const el = this.el;
                const radius = 12;
                const sides = 16;
                const wallHeight = 6;
                const wallWidth = 4.8;

                for (let i = 0; i < sides; i++) {
                    const angleDeg = (i / sides) * 360;
                    const angleRad = THREE.MathUtils.degToRad(angleDeg);
                    const x = radius * Math.cos(angleRad);
                    const z = radius * Math.sin(angleRad);
                    const rotationY = -angleDeg + 90;

                    const wall = document.createElement('a-plane');
                    wall.setAttribute('width', wallWidth);
                    wall.setAttribute('height', wallHeight);
                    wall.setAttribute('position', `${x} ${wallHeight / 2} ${z}`);
                    wall.setAttribute('rotation', `0 ${rotationY} 0`);
                    wall.setAttribute('material', {
                        src: '#wall-texture',
                        roughness: 0.85,
                        metalness: 0.05,
                        side: 'double'
                    });

                    el.appendChild(wall);
                }
            }
        });

        /* ===============================
           TELEPORT HANDLER (SMOOTH)
        =============================== */
        AFRAME.registerComponent('teleport-handler', {
            init: function () {
                this.el.addEventListener('click', () => {
                    const rig = document.querySelector('#rig');
                    const pos = this.el.getAttribute('position');

                    rig.setAttribute('animation', {
                        property: 'position',
                        to: `${pos.x} 0 ${pos.z}`,
                        dur: 400,
                        easing: 'easeOutQuad'
                    });
                });

                this.el.addEventListener('mouseenter', () => {
                    this.el.setAttribute('material', 'emissiveIntensity', 1);
                });

                this.el.addEventListener('mouseleave', () => {
                    this.el.setAttribute('material', 'emissiveIntensity', 0.6);
                });
            }
        });
    </script>
</head>

<body>
    <a-scene background="color: #111" vr-mode-ui="enabled: true" renderer="antialias: false; precision: mediump">

        <!-- ===============================
             ASSETS
        =============================== -->
        <a-assets>
            <img id="my-photo-1-asset" src="IMG_6473.PNG" crossorigin="anonymous">
            <img id="floor-texture" src="floor_texture.jpg">
            <img id="wall-texture" src="wall_texture.jpg">
        </a-assets>

        <!-- ===============================
             FLOOR
        =============================== -->
        <a-circle rotation="-90 0 0" radius="14"
            material="src: #floor-texture; repeat: 10 10; roughness: 0.4; metalness: 0.05">
        </a-circle>

        <!-- ===============================
             CEILING
        =============================== -->
        <a-circle rotation="90 0 0" radius="14" position="0 6 0" material="color: #eeeeee; roughness: 1; side: double">
        </a-circle>

        <!-- ===============================
             WALLS
        =============================== -->
        <a-entity hexadecagon-walls></a-entity>

        <!-- ===============================
             LIGHTING (REALISTIC + MOBILE SAFE)
        =============================== -->
        <a-entity light="type: hemisphere; color: #ffffff; groundColor: #d6cfc7; intensity: 0.7"></a-entity>

        <a-entity light="type: point; color: #fff2cc; intensity: 0.6; distance: 30" position="0 5 0" animation="property: light.intensity;
                       from: 0.5;
                       to: 0.7;
                       dir: alternate;
                       dur: 4000;
                       loop: true">
        </a-entity>

        <a-entity light="type: point; intensity: 0.4; distance: 20" position="6 3 0"></a-entity>
        <a-entity light="type: point; intensity: 0.4; distance: 20" position="-6 3 0"></a-entity>

        <!-- ===============================
             TELEPORT PADS
        =============================== -->
        <a-cylinder position="0 0.1 0" radius="0.5" height="0.1"
            material="color: #ff4444; emissive: #ff0000; emissiveIntensity: 0.6" teleport-handler></a-cylinder>

        <a-cylinder position="0 0.1 -6" radius="0.5" height="0.1"
            material="color: #ff4444; emissive: #ff0000; emissiveIntensity: 0.6" teleport-handler></a-cylinder>

        <a-cylinder position="4 0.1 -4" radius="0.5" height="0.1"
            material="color: #ff4444; emissive: #ff0000; emissiveIntensity: 0.6" teleport-handler></a-cylinder>

        <a-cylinder position="-4 0.1 -4" radius="0.5" height="0.1"
            material="color: #ff4444; emissive: #ff0000; emissiveIntensity: 0.6" teleport-handler></a-cylinder>

        <!-- ===============================
             ART DISPLAY (ANIMATED)
        =============================== -->
        <a-entity position="0 2.2 -11.9" animation="property: position;
                       to: 0 2.25 -11.9;
                       dir: alternate;
                       dur: 3000;
                       easing: easeInOutSine;
                       loop: true">

            <!-- Frame -->
            <a-box width="4.4" height="3.4" depth="0.15" material="color: #8b5a2b; roughness: 0.6; metalness: 0.2">
            </a-box>

            <!-- Inner Mat -->
            <a-plane width="4.1" height="3.1" position="0 0 0.08" color="#eeeeee"></a-plane>

            <!-- Image -->
            <a-image src="#my-photo-1-asset" width="4" height="3" position="0 0 0.12" material="shader: flat"></a-image>

            <!-- Fake Shadow -->
            <a-plane width="4.5" height="0.3" position="0 -1.9 0.13"
                material="color: #000; opacity: 0.25; shader: flat">
            </a-plane>

            <!-- Label -->
            <a-plane width="1.6" height="0.6" position="0 -2.3 0.15" color="#222">
                <a-text value="Museum Masterpiece\nOil on Canvas, 2024" align="center" width="4" color="white">
                </a-text>
            </a-plane>
        </a-entity>

        <!-- ===============================
             CAMERA RIG (JIODIVE READY)
        =============================== -->
        <a-entity id="rig" position="0 0 0">
            <a-entity camera look-controls wasd-controls position="0 1.6 0">
                <a-cursor position="0 0 -1" geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                    material="color: yellow; shader: flat" fuse="true" fuse-timeout="1500">
                </a-cursor>
            </a-entity>
        </a-entity>

    </a-scene>
</body>

</html>
