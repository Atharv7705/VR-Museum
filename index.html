<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>VR Museum â€“ JioDive Ready</title>

    <!-- A-Frame 1.2.0 (Most stable for Cardboard/JioDive) -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>

    <script>
        /* ===============================
           HEXADECAGON WALLS (MOBILE SAFE)
        =============================== */
        AFRAME.registerComponent('hexadecagon-walls', {
            init: function () {
                const el = this.el;
                const radius = 12;
                const sides = 16;
                const wallHeight = 6;
                const wallWidth = 4.8;

                for (let i = 0; i < sides; i++) {
                    const angle = (i / sides) * Math.PI * 2;
                    const x = radius * Math.cos(angle);
                    const z = radius * Math.sin(angle);
                    const rotY = -THREE.Math.radToDeg(angle) + 90;

                    const wall = document.createElement('a-plane');
                    wall.setAttribute('width', wallWidth);
                    wall.setAttribute('height', wallHeight);
                    wall.setAttribute('position', `${x} ${wallHeight / 2} ${z}`);
                    wall.setAttribute('rotation', `0 ${rotY} 0`);

                    // MOBILE SAFE MATERIAL (NO PBR)
                    wall.setAttribute('material', {
                        src: '#wall-texture',
                        shader: 'standard',
                        roughness: 1,
                        metalness: 0,
                        side: 'double'
                    });

                    el.appendChild(wall);
                }
            }
        });

        /* ===============================
           TELEPORT (NO MOTION SICKNESS)
        =============================== */
        AFRAME.registerComponent('teleport-handler', {
            init: function () {
                this.el.addEventListener('click', () => {
                    const rig = document.querySelector('#rig');
                    const pos = this.el.getAttribute('position');

                    rig.setAttribute('position', {
                        x: pos.x,
                        y: 0,
                        z: pos.z
                    });
                });
            }
        });
    </script>
</head>

<body>
<a-scene
    background="color: #111"
    vr-mode-ui="enabled: true"
    loading-screen="backgroundColor: black; dotsColor: white"
    renderer="precision: mediump; antialias: false">

    <!-- ===============================
         ASSETS (LOW RES FOR MOBILE)
    =============================== -->
    <a-assets timeout="10000">
        <img id="wall-texture" src="wall_texture.jpg">
        <img id="floor-texture" src="floor_texture.jpg">
        <img id="art-image" src="img_6473.jpg">
    </a-assets>

    <!-- ===============================
         LIGHTING (MOBILE SAFE)
    =============================== -->
    <a-entity light="type: ambient; intensity: 1"></a-entity>
    <a-entity light="type: point; intensity: 0.5" position="0 5 0"></a-entity>

    <!-- ===============================
         FLOOR
    =============================== -->
    <a-circle rotation="-90 0 0" radius="14"
        material="src: #floor-texture; shader: standard; roughness: 1">
    </a-circle>

    <!-- ===============================
         CEILING
    =============================== -->
    <a-circle rotation="90 0 0" radius="14" position="0 6 0"
        material="color: #e0e0e0; shader: standard; side: double">
    </a-circle>

    <!-- ===============================
         WALLS
    =============================== -->
    <a-entity hexadecagon-walls></a-entity>

    <!-- ===============================
         TELEPORT PADS
    =============================== -->
    <a-cylinder position="0 0.1 0" radius="0.5" height="0.1"
        material="color: red" teleport-handler></a-cylinder>

    <a-cylinder position="0 0.1 -6" radius="0.5" height="0.1"
        material="color: red" teleport-handler></a-cylinder>

    <a-cylinder position="4 0.1 -4" radius="0.5" height="0.1"
        material="color: red" teleport-handler></a-cylinder>

    <a-cylinder position="-4 0.1 -4" radius="0.5" height="0.1"
        material="color: red" teleport-handler></a-cylinder>

    <!-- ===============================
         ART DISPLAY
    =============================== -->
    <a-entity position="0 2.2 -11.9">

        <!-- Frame -->
        <a-box width="4.4" height="3.4" depth="0.15"
            material="color: #b87333; shader: standard">
        </a-box>

        <!-- Image (FLAT = ALWAYS VISIBLE) -->
        <a-image src="#art-image" width="4" height="3"
            position="0 0 0.12"
            material="shader: flat">
        </a-image>

        <!-- Label -->
        <a-plane width="1.6" height="0.4" position="0 -2.2 0.15"
            material="color: #222">
            <a-text value="Museum Masterpiece"
                align="center"
                color="white"
                width="4">
            </a-text>
        </a-plane>
    </a-entity>

    <!-- ===============================
         CAMERA RIG (JIODIVE READY)
    =============================== -->
    <a-entity id="rig" position="0 0 0">
        <a-entity camera look-controls position="0 1.6 0">
            <a-cursor
                geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                material="color: yellow; shader: flat"
                fuse="true"
                fuse-timeout="1500">
            </a-cursor>
        </a-entity>
    </a-entity>

</a-scene>
</body>
</html>
